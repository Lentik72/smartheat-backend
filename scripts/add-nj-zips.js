const fs = require('fs');
const zipDbPath = '/Users/leo/Desktop/HeatingOil/SmartHeatIOS/backend/src/data/zip-database.json';
const zipDb = JSON.parse(fs.readFileSync(zipDbPath));

// NJ ZIPs by county - comprehensive list
const njZips = {
  // Bergen County (Northeast NJ - Paramus, Hackensack, Fort Lee)
  'Bergen': [
    '07401', '07407', '07410', '07417', '07418', '07423', '07430', '07432', '07436',
    '07450', '07451', '07452', '07458', '07463', '07481', '07495', '07601', '07602',
    '07603', '07604', '07605', '07606', '07607', '07608', '07620', '07621', '07624',
    '07626', '07627', '07628', '07630', '07631', '07632', '07640', '07641', '07642',
    '07643', '07644', '07645', '07646', '07647', '07648', '07649', '07650', '07652',
    '07653', '07656', '07657', '07660', '07661', '07662', '07663', '07666', '07670',
    '07675', '07676', '07677'
  ],
  // Essex County (Newark, Montclair, Orange)
  'Essex': [
    '07003', '07004', '07006', '07007', '07009', '07017', '07018', '07019', '07021',
    '07028', '07039', '07040', '07041', '07042', '07043', '07044', '07050', '07051',
    '07052', '07068', '07078', '07079', '07101', '07102', '07103', '07104', '07105',
    '07106', '07107', '07108', '07109', '07110', '07111', '07112', '07114'
  ],
  // Hudson County (Jersey City, Hoboken, Bayonne)
  'Hudson': [
    '07002', '07029', '07030', '07031', '07032', '07047', '07086', '07087', '07093',
    '07094', '07096', '07097', '07302', '07303', '07304', '07305', '07306', '07307',
    '07308', '07309', '07310', '07311', '07395', '07399'
  ],
  // Passaic County (Paterson, Clifton, Wayne)
  'Passaic': [
    '07470', '07474', '07480', '07501', '07502', '07503', '07504', '07505', '07506',
    '07507', '07508', '07509', '07510', '07511', '07512', '07513', '07514', '07522',
    '07524', '07533', '07538', '07543', '07544'
  ],
  // Middlesex County (Edison, New Brunswick, Perth Amboy)
  'Middlesex': [
    '07001', '07008', '07064', '07067', '07077', '07080', '07095', '08536', '08810',
    '08812', '08816', '08817', '08818', '08820', '08824', '08828', '08830', '08831',
    '08832', '08837', '08840', '08846', '08850', '08852', '08854', '08855', '08857',
    '08859', '08861', '08862', '08863', '08871', '08872', '08873', '08875', '08879',
    '08882', '08884', '08899', '08901', '08902', '08903', '08904', '08906'
  ],
  // Monmouth County (shore area - Red Bank, Long Branch, Freehold)
  'Monmouth': [
    '07701', '07702', '07703', '07704', '07709', '07710', '07711', '07712', '07715',
    '07716', '07717', '07718', '07719', '07720', '07721', '07722', '07723', '07724',
    '07726', '07727', '07728', '07730', '07731', '07732', '07733', '07734', '07735',
    '07737', '07738', '07739', '07740', '07746', '07747', '07748', '07750', '07751',
    '07752', '07753', '07754', '07755', '07756', '07757', '07758', '07760', '07762',
    '07764', '07765', '08501', '08510', '08514', '08520', '08525', '08535', '08555'
  ],
  // Ocean County (Toms River, Lakewood, Brick)
  'Ocean': [
    '08005', '08006', '08008', '08050', '08087', '08092', '08527', '08533', '08701',
    '08720', '08721', '08722', '08723', '08724', '08730', '08731', '08732', '08733',
    '08734', '08735', '08736', '08738', '08739', '08740', '08741', '08742', '08750',
    '08751', '08752', '08753', '08754', '08755', '08756', '08757', '08758', '08759'
  ],
  // Union County (Elizabeth, Union, Plainfield)
  'Union': [
    '07016', '07023', '07027', '07033', '07036', '07060', '07061', '07062', '07063',
    '07065', '07066', '07076', '07081', '07083', '07088', '07090', '07091', '07092',
    '07201', '07202', '07203', '07204', '07205', '07206', '07207', '07208'
  ],
  // Somerset County (Somerville, Bridgewater)
  'Somerset': [
    '07920', '07921', '07924', '07931', '07933', '07934', '07938', '07939', '07945',
    '07946', '07950', '07960', '07961', '07962', '07963', '07969', '07970', '07974',
    '07977', '07978', '07979', '07980', '07981', '08502', '08504', '08528', '08540',
    '08542', '08543', '08544', '08550', '08553', '08558', '08559', '08560', '08807',
    '08821', '08823', '08835', '08836', '08844', '08853', '08869', '08876', '08880', '08890'
  ]
};

let added = 0;
for (const [county, zips] of Object.entries(njZips)) {
  for (const zip of zips) {
    if (!zipDb[zip]) {
      zipDb[zip] = { state: 'NJ', county: county };
      added++;
    }
  }
}

fs.writeFileSync(zipDbPath, JSON.stringify(zipDb, null, 2));
console.log('Added ' + added + ' new NJ ZIPs');
console.log('Total ZIPs in database: ' + Object.keys(zipDb).length);

// Verify by county
const njInDb = Object.entries(zipDb).filter(([z, info]) => info.state === 'NJ');
const byCty = {};
for (const [z, info] of njInDb) {
  byCty[info.county] = (byCty[info.county] || 0) + 1;
}
console.log('\nNJ counties now in database:');
for (const [c, n] of Object.entries(byCty).sort((a,b) => b[1] - a[1])) {
  console.log('  ' + c + ': ' + n + ' ZIPs');
}
